

<script>
    // ====================================== [ èªæ–‡è³‡æ–™åº« ] =======================================
    /**
     * 100 é¡Œå¹¼å…’åœ’å¡«å……å•ç­”å¥ï¼šä½¿ç”¨ [[å¥å­], [æ­£ç¢ºç­”æ¡ˆ], [æ··æ·†é¸é …1], [æ··æ·†é¸é …2]] æ ¼å¼
     */
    const quizData = [
        [["å¤ªé™½å‡ºä¾†äº†ï¼Œå…¬é›åœ¨å«", "ã€‚", "å–”"], ["å–”", "å‘€", "å•Š"], "å¹¼å…’åœ’å°ç­"],
        [["ä¸‹é›¨äº†ï¼Œæˆ‘è¦ç©¿", "é‹ã€‚"], ["é›¨", "æ°´", "åœŸ"], "å¹¼å…’åœ’å°ç­"],
        [["å°è²“å’ªå–œæ­¡åƒ", "é­šã€‚"], ["å°", "å¤§", "ä¸­"], "å¹¼å…’åœ’å°ç­"],
        [["æˆ‘å–œæ­¡å»", "åœ’ç©ã€‚"], ["å…¬", "å­¸", "å®¶"], "å¹¼å…’åœ’å°ç­"],
        [["ç´…ç‡ˆåœï¼Œ", "ç‡ˆè¡Œã€‚"], ["ç¶ ", "é»ƒ", "è—"], "å¹¼å…’åœ’å°ç­"],
        [["è˜‹æœæ˜¯", "è‰²çš„ã€‚"], ["ç´…", "é»ƒ", "ç¶ "], "å¹¼å…’åœ’å°ç­"],
        [["æˆ‘æœƒç”¨", "æ‰‹åƒé£¯ã€‚"], ["ç­·", "ç¢—", "ç›¤"], "å¹¼å…’åœ’å°ç­"],
        [["å¤©ä¸Šæœ‰å¾ˆå¤š", "æ˜Ÿã€‚"], ["äº®", "åœ“", "å°"], "å¹¼å…’åœ’å°ç­"],
        [["åƒé£¯å‰è¦", "æ‰‹ã€‚"], ["æ´—", "æ“¦", "æ‘¸"], "å¹¼å…’åœ’å°ç­"],
        [["å°ç‹—å–œæ­¡", "éª¨é ­ã€‚"], ["åƒ", "å–", "ç©"], "å¹¼å…’åœ’å°ç­"],
        [["é­šå…’åœ¨", "è£¡æ¸¸ã€‚"], ["æ°´", "åœ°", "å¤©"], "å¹¼å…’åœ’å°ç­"],
        [["åª½åª½çµ¦æˆ‘", "æŠ±æŠ±ã€‚"], ["ä¸€å€‹", "äºŒå€‹", "ä¸‰å€‹"], "å¹¼å…’åœ’å°ç­"],
        [["æ™šä¸Šæœˆäº®", "ä¾†äº†ã€‚"], ["å‡º", "é€²", "å»"], "å¹¼å…’åœ’å°ç­"],
        [["æˆ‘å€‘éƒ½æ˜¯å¥½", "å‹ã€‚"], ["æœ‹", "æ•µ", "ä¼´"], "å¹¼å…’åœ’å°ç­"],
        [["ç”Ÿæ—¥è¦åƒ", "ç³•ã€‚"], ["è›‹", "éºµ", "é£¯"], "å¹¼å…’åœ’å°ç­"],
        
        [["æ˜¥å¤©åˆ°äº†ï¼ŒèŠ±", "é–‹äº†ã€‚"], ["æœµ", "èŠ½", "è‘‰"], "å¹¼å…’åœ’ä¸­ç­"],
        [["æˆ‘å­¸æœƒäº†", "å­—ã€‚"], ["å¯«", "ç•«", "è®€"], "å¹¼å…’åœ’ä¸­ç­"],
        [["å°é³¥åœ¨", "ä¸Šå”±æ­Œã€‚"], ["æ¨¹", "åœ°", "æ°´"], "å¹¼å…’åœ’ä¸­ç­"],
        [["é¢¨å…’å¹éï¼Œ", "å­é£„ã€‚"], ["è‘‰", "èŠ±", "è‰"], "å¹¼å…’åœ’ä¸­ç­"],
        [["æˆ‘å€‘ç”¨", "ç›çœ‹ä¸–ç•Œã€‚"], ["çœ¼", "è€³", "å£"], "å¹¼å…’åœ’ä¸­ç­"],
        [["å¹«åª½åª½", "è¡£æœã€‚"], ["æ‘º", "æ´—", "ç©¿"], "å¹¼å…’åœ’ä¸­ç­"],
        [["å°æ‰‹", "æ‰‹æ‹ä¸€æ‹ã€‚"], ["æ‹", "æ‘¸", "æ‰“"], "å¹¼å…’åœ’ä¸­ç­"],
        [["å¤§è±¡æœ‰é•·é•·çš„", "å­ã€‚"], ["é¼»", "è€³", "è…³"], "å¹¼å…’åœ’ä¸­ç­"],
        [["å¤ªé™½æŠŠ", "å…‰é€çµ¦æˆ‘å€‘ã€‚"], ["é™½", "æœˆ", "æ˜Ÿ"], "å¹¼å…’åœ’ä¸­ç­"],
        [["ç¡è¦ºå‰è¦", "ç‰™ã€‚"], ["åˆ·", "æ´—", "åƒ"], "å¹¼å…’åœ’ä¸­ç­"],
        [["æ•¸æ•¸çœ‹ï¼Œæˆ‘æœ‰å¹¾æ ¹", "æŒ‡ã€‚"], ["æ‰‹", "è…³", "é ­"], "å¹¼å…’åœ’ä¸­ç­"],
        [["å°å…”å­", "å–œæ­¡è·³ã€‚"], ["å¾ˆ", "ä¸", "å¿«"], "å¹¼å…’åœ’ä¸­ç­"],
        [["æˆ‘å€‘æœƒé•·", "å¤§ã€‚"], ["å¿«", "æ…¢", "é«˜"], "å¹¼å…’åœ’ä¸­ç­"],
        [["å°é­šåå‡º", "æ³¡æ³¡ã€‚"], ["åœ“åœ“çš„", "æ–¹æ–¹çš„", "é•·é•·çš„"], "å¹¼å…’åœ’ä¸­ç­"],
        [["æˆ‘å€‘æ˜¯", "å¥½çš„å°æœ‹å‹ã€‚"], ["ä¹–", "å£", "åµ"], "å¹¼å…’åœ’ä¸­ç­"],
        
        [["æˆ‘è¦", "æŒæ¯å¤©é‹å‹•ã€‚"], ["å …", "ä¿", "ç¶­"], "å¹¼å…’åœ’å¤§ç­"],
        [["åœ°çƒæ˜¯æˆ‘å€‘", "çš„å®¶ã€‚"], ["å…±åŒ", "è‡ªå·±", "åˆ¥äºº"], "å¹¼å…’åœ’å¤§ç­"],
        [["é‡åˆ°å›°é›£è¦", "è¾¦æ³•ã€‚"], ["æƒ³", "æ‰¾", "å•"], "å¹¼å…’åœ’å¤§ç­"],
        [["åˆ†äº«ç©å…·ï¼Œå¤§å®¶", "å¿«æ¨‚ã€‚"], ["éƒ½", "æ›´", "æœ€"], "å¹¼å…’åœ’å¤§ç­"],
        [["æˆ‘çš„å¿ƒè£¡", "è‘—æ„›ã€‚"], ["è£", "æ”¾", "è—"], "å¹¼å…’åœ’å¤§ç­"],
        [["æˆ‘å€‘è¦", "è­·ç’°å¢ƒã€‚"], ["ä¿", "ç¶­", "æ„›"], "å¹¼å…’åœ’å¤§ç­"],
        [["èªªè©±æ™‚è¦", "å°æ–¹çš„çœ¼ç›ã€‚"], ["çœ‹", "ç›¯", "é–‰"], "å¹¼å…’åœ’å¤§ç­"],
        [["å­¸æœƒèªª", "è¬è¬ã€å°ä¸èµ·ã€è«‹ã€‚"], ["ä¸‰å¥è©±", "å…©å¥è©±", "ä¸€å¥è©±"], "å¹¼å…’åœ’å¤§ç­"],
        [["æˆ‘æœƒ", "åŠ©çˆ¸çˆ¸åª½åª½åšå®¶äº‹ã€‚"], ["å¹«", "è«‹", "å«"], "å¹¼å…’åœ’å¤§ç­"],
        [["æ˜Ÿæ˜Ÿåœ¨", "ä¸Šçœ¨çœ¼ç›ã€‚"], ["å¤œç©º", "ç™½å¤©", "é›²å±¤"], "å¹¼å…’åœ’å¤§ç­"],
        [["æˆ‘å€‘ç”¨", "é‡å‰µé€ ç¾å¥½ä¸–ç•Œã€‚"], ["åŠ›", "æ„›", "å¿ƒ"], "å¹¼å…’åœ’å¤§ç­"],
        [["å­¸æœƒ", "è½åˆ¥äººçš„æ„è¦‹ã€‚"], ["å‚¾", "èªª", "è¬›"], "å¹¼å…’åœ’å¤§ç­"],
        [["æˆ‘çš„å¤¢æƒ³æ˜¯æˆç‚ºä¸€å", "ã€‚"], ["å¤ªç©ºäºº", "å»šå¸«", "è€å¸«"], "å¹¼å…’åœ’å¤§ç­"],
        [["æ¯å€‹äººéƒ½æœ‰ç¨ç‰¹çš„", "è™•ã€‚"], ["é•·", "çŸ­", "å„ª"], "å¹¼å…’åœ’å¤§ç­"],
        [["åœ˜çµåŠ›é‡", "å¤§ã€‚"], ["æœ€", "å¾ˆ", "ä¸"], "å¹¼å…’åœ’å¤§ç­"],
        
        // æ›´å¤šé¡Œç›®... (å·²è¶³å¤  100 é¡Œå·¦å³ï¼Œä¿ç•™å®Œæ•´æ€§)
        [["å°èœœèœ‚", "èŠ±èœœã€‚"], ["æ¡", "å–", "æ‰¾"], "å¹¼å…’åœ’å¤§ç­"],
        [["è´è¶", "è‘—ç¾éº—çš„èŠ±æœµã€‚"], ["ç¹", "é£›", "åœ"], "å¹¼å…’åœ’å¤§ç­"],
        [["æˆ‘å€‘æ˜¯", "åœ‹çš„æœªä¾†ã€‚"], ["ç¥–", "åˆ¥", "ä»–"], "å¹¼å…’åœ’å¤§ç­"],
        [["è«‹è¨˜å¾—", "æ„›å‹•ç‰©ã€‚"], ["å–„", "å–œ", "é¤Š"], "å¹¼å…’åœ’ä¸­ç­"],
        [["å°ç¾Šçš„æ¯›", "ç™½ç™½çš„ã€‚"], ["æ˜¯", "å¾ˆ", "ä¹Ÿ"], "å¹¼å…’åœ’å°ç­"],
        [["æˆ‘å–œæ­¡", "æ­Œè·³èˆã€‚"], ["å”±", "è½", "çœ‹"], "å¹¼å…’åœ’å°ç­"],
        [["ä¸€èµ·", "æˆ²å§ã€‚"], ["éŠ", "è®€", "å¯«"], "å¹¼å…’åœ’å°ç­"],
        [["é€™æ˜¯ä¸€æœ¬", "ç•«æ›¸ã€‚"], ["åœ–", "æ–‡", "æ¼«"], "å¹¼å…’åœ’ä¸­ç­"],
        [["æˆ‘çš„", "åŒ…è£¡æœ‰æ°´å£ºã€‚"], ["æ›¸", "ç­†", "è¢‹"], "å¹¼å…’åœ’ä¸­ç­"],
        [["å¤©ç©º", "è—è‰²ã€‚"], ["æ˜¯", "åƒ", "å¾ˆ"], "å¹¼å…’åœ’ä¸­ç­"],
        
        [["å¤§æµ·è£¡æœ‰å¾ˆå¤š", "é­šã€‚"], ["å¤§", "å°", "å¤š"], "å¹¼å…’åœ’å°ç­"],
        [["æˆ‘å€‘æ˜¯", "æœ‹å‹ã€‚"], ["å¥½", "å£", "çœŸ"], "å¹¼å…’åœ’å°ç­"],
        [["å°ç‹—æ±ªæ±ª", "ã€‚"], ["å«", "è·³", "è·‘"], "å¹¼å…’åœ’å°ç­"],
        [["è²“é ­é·¹", "ä¸Šå‡ºä¾†æ´»å‹•ã€‚"], ["æ™š", "æ—©", "åˆ"], "å¹¼å…’åœ’ä¸­ç­"],
        [["è«‹", "åˆ¥äººå¹«å¿™ã€‚"], ["å°‹æ±‚", "ç­‰å¾…", "æ‹’çµ•"], "å¹¼å…’åœ’å¤§ç­"],
        [["èª å¯¦æ˜¯æœ€å¥½çš„", "ã€‚"], ["ç¾å¾·", "æ­¦å™¨", "ç¦®ç‰©"], "å¹¼å…’åœ’å¤§ç­"],
        [["æˆ‘", "æ­¡å­¸ç¿’æ–°çŸ¥è­˜ã€‚"], ["å–œ", "ä¸", "æ„›"], "å¹¼å…’åœ’ä¸­ç­"],
        [["æˆ‘å€‘ä¸€èµ·", "ç•«å§ã€‚"], ["ç•«", "å¡—", "æ"], "å¹¼å…’åœ’ä¸­ç­"],
        [["è«‹", "æ…¢èµ°è·¯ã€‚"], ["æ…¢", "å¿«", "èµ°"], "å¹¼å…’åœ’å°ç­"],
        [["å°", "å­æœƒé•·å¤§ã€‚"], ["å­©", "æ¨¹", "èŠ±"], "å¹¼å…’åœ’å°ç­"],
        
        [["æˆ‘æ„›", "åª½åª½ã€‚"], ["æˆ‘", "ä½ ", "å¥¹"], "å¹¼å…’åœ’å°ç­"],
        [["é³¥å…’æœ‰", "é›™ç¿…è†€ã€‚"], ["å…©", "ä¸€", "ä¸‰"], "å¹¼å…’åœ’ä¸­ç­"],
        [["æˆ‘å€‘", "å­¸ç¿’åˆ†äº«ã€‚"], ["è¦", "ä¸", "æœƒ"], "å¹¼å…’åœ’ä¸­ç­"],
        [["å°", "èŸ²åœ¨çˆ¬ã€‚"], ["æ¯›", "å¤§", "ç´…"], "å¹¼å…’åœ’ä¸­ç­"],
        [["æˆ‘", "ç¶“åŠªåŠ›äº†ã€‚"], ["å·²", "æœª", "æ­£"], "å¹¼å…’åœ’å¤§ç­"],
        [["è«‹", "åˆ¥äººçš„æ„Ÿå—ã€‚"], ["å°Šé‡", "å¿½ç•¥", "æ¨¡ä»¿"], "å¹¼å…’åœ’å¤§ç­"],
        [["æˆ‘å€‘", "äº’ç›¸å¹«åŠ©ã€‚"], ["æ‡‰ç•¶", "ä¸è¦", "æˆ–è¨±"], "å¹¼å…’åœ’å¤§ç­"],
        [["é›²æœµåƒ", "ä¸€æ¨£ã€‚"], ["æ£‰èŠ±ç³–", "çŸ³é ­", "ç£šå¡Š"], "å¹¼å…’åœ’å¤§ç­"],
        [["æˆ‘æœƒ", "å¿ƒè½æ•…äº‹ã€‚"], ["å°ˆ", "åˆ†", "ä¸"], "å¹¼å…’åœ’ä¸­ç­"],
        [["å°", "æ‰‹æ‰‹æ´—ä¹¾æ·¨ã€‚"], ["é«’", "æ·¨", "ç´…"], "å¹¼å…’åœ’å°ç­"],
        
        [["æˆ‘", "æ„›åƒæ°´æœã€‚"], ["æœ€", "ä¸", "éƒ½"], "å¹¼å…’åœ’å°ç­"],
        [["è«‹", "è¼•åœ°é—œé–€ã€‚"], ["è¼•", "é‡", "å¿«"], "å¹¼å…’åœ’ä¸­ç­"],
        [["æˆ‘å€‘è¦", "å°å¾…æœ‹å‹ã€‚"], ["å‹å–„", "æ•µå°", "å†·æ¼ "], "å¹¼å…’åœ’å¤§ç­"],
        [["å°", "é›å˜°å˜°å«ã€‚"], ["é»ƒ", "ç™½", "é»‘"], "å¹¼å…’åœ’å°ç­"],
        [["æˆ‘", "æœƒè‡ªå·±ç©¿è¡£æœã€‚"], ["å·²", "æœª", "æ­£"], "å¹¼å…’åœ’ä¸­ç­"],
        [["è«‹", "éœåœ°ä¼‘æ¯ã€‚"], ["å®‰", "åµ", "å¿«"], "å¹¼å…’åœ’ä¸­ç­"],
        [["æˆ‘å€‘è¦", "å®ˆäº¤é€šè¦å‰‡ã€‚"], ["éµ", "é•", "ä¸"], "å¹¼å…’åœ’å¤§ç­"],
        [["å°", "èˆ¹åœ¨æ°´ä¸Šé£„ã€‚"], ["å°", "å¤§", "å¿«"], "å¹¼å…’åœ’å°ç­"],
        [["æˆ‘å–œæ­¡", "é¡è‰²çš„ä¸–ç•Œã€‚"], ["å½©", "é»‘", "ç™½"], "å¹¼å…’åœ’å¤§ç­"],
        [["æˆ‘å€‘", "å¤©å¤©é–‹å¿ƒã€‚"], ["è¦", "ä¸", "éƒ½"], "å¹¼å…’åœ’å°ç­"],

        [["ä¸€èµ·", "ç¿’å¯«å­—ã€‚"], ["ç·´", "å­¸", "çœ‹"], "å¹¼å…’åœ’ä¸­ç­"],
        [["è«‹", "åˆ¥äººåˆ†äº«ã€‚"], ["å’Œ", "èˆ‡", "å°"], "å¹¼å…’åœ’å¤§ç­"],
        [["æˆ‘æœƒ", "è‡ªå·±çš„ç©å…·ã€‚"], ["æ”¶", "æ”¾", "ç©"], "å¹¼å…’åœ’å°ç­"],
        [["æ¨¹è‘‰æ˜¯", "è‰²çš„ã€‚"], ["ç¶ ", "ç´…", "é»ƒ"], "å¹¼å…’åœ’ä¸­ç­"],
        [["æˆ‘å€‘", "è¦å‹‡æ•¢å˜—è©¦ã€‚"], ["éƒ½", "ä¸", "æœƒ"], "å¹¼å…’åœ’å¤§ç­"],
        [["æˆ‘", "æœƒèªªè¬è¬ã€‚"], ["å·²", "æœª", "æ­£"], "å¹¼å…’åœ’å°ç­"],
        [["è«‹", "å°è²èªªè©±ã€‚"], ["å°", "å¤§", "è¼•"], "å¹¼å…’åœ’ä¸­ç­"],
        [["æˆ‘å€‘è¦", "è­·çœ¼ç›ã€‚"], ["ä¿", "æ„›", "çœ‹"], "å¹¼å…’åœ’å¤§ç­"],
        [["å°", "é­šæ¸¸å¾—å¿«ã€‚"], ["å¿«", "æ…¢", "æ…¢"], "å¹¼å…’åœ’å°ç­"],
        [["æˆ‘", "å–œæ­¡è½æ•…äº‹ã€‚"], ["æœ€", "ä¸", "ä¹Ÿ"], "å¹¼å…’åœ’ä¸­ç­"],

        [["è«‹", "å¹«æˆ‘ã€‚"], ["æ‚¨", "ä½ ", "ä»–"], "å¹¼å…’åœ’å°ç­"],
        [["æˆ‘å€‘è¦", "æ•´é½Šæ’éšŠã€‚"], ["æ’", "ç«™", "èµ°"], "å¹¼å…’åœ’ä¸­ç­"],
        [["æˆ‘", "æœƒè‡ªå·±åƒé£¯ã€‚"], ["å·²", "æœª", "æ­£"], "å¹¼å…’åœ’å¤§ç­"],
        [["å°", "èŠ±é–‹äº†ã€‚"], ["ç´…", "ç™½", "é»ƒ"], "å¹¼å…’åœ’å°ç­"],
        [["è«‹", "è¨˜å¾—å¾®ç¬‘ã€‚"], ["å¸¸", "å¶", "ä¸"], "å¹¼å…’åœ’ä¸­ç­"],
        [["æˆ‘å€‘è¦", "æƒœé£Ÿç‰©ã€‚"], ["ç", "æ„›", "å–œ"], "å¹¼å…’åœ’å¤§ç­"],
        [["æˆ‘", "æ„›æˆ‘çš„å®¶ã€‚"], ["å¾ˆ", "ä¸", "ä¹Ÿ"], "å¹¼å…’åœ’å°ç­"],
        [["è«‹", "ä¿æŒå®‰éœã€‚"], ["å‹™å¿…", "ä¸è¦", "å¯ä»¥"], "å¹¼å…’åœ’ä¸­ç­"],
        [["æˆ‘å€‘è¦", "æŒå¥½ç¿’æ…£ã€‚"], ["ä¿", "å­¸", "ç·´"], "å¹¼å…’åœ’å¤§ç­"],
        [["å°", "æœ‹å‹æ‰‹ç‰½æ‰‹ã€‚"], ["å¥½", "å£", "çœŸ"], "å¹¼å…’åœ’å°ç­"],
    ];

    // ====================================== [ æ ¸å¿ƒè®Šæ•¸ ] =======================================
    let currentStage = 'å¹¼å…’åœ’å°ç­'; // ç•¶å‰é¸æ“‡çš„é—œå¡
    let currentQuestionIndex = 0;   // ç•¶å‰é¡Œç›®ç´¢å¼•
    let filteredQuizData = [];      // æ ¹æ“šé—œå¡ç¯©é¸å‡ºçš„é¡Œç›®
    let score = 0;                  // åˆ†æ•¸
    let totalQuestions = 0;         // ç¸½é¡Œæ•¸

    // ====================================== [ DOM å…ƒç´  ] =======================================
    // ç¢ºä¿é€™è£¡çš„ ID å’Œ HTML ä¸­çš„ ID å®Œå…¨åŒ¹é…ï¼šquiz-stage-selectors, language-game, quiz-feedback-area
    const stageSelectorsEl = document.getElementById('quiz-stage-selectors');
    const languageGameEl = document.getElementById('language-game');
    const feedbackEl = document.getElementById('quiz-feedback-area');

    // ====================================== [ æ ¸å¿ƒé‚è¼¯ ] =======================================
    
    /**
     * æ¸²æŸ“é—œå¡é¸æ“‡æŒ‰éˆ•
     */
    function renderStageSelectors() {
        const stages = ['å¹¼å…’åœ’å°ç­', 'å¹¼å…’åœ’ä¸­ç­', 'å¹¼å…’åœ’å¤§ç­'];
        
        // å®‰å…¨æª¢æŸ¥ï¼Œå¦‚æœå…ƒç´ ä¸å­˜åœ¨ï¼Œå‰‡ä¸åŸ·è¡Œ
        if (!stageSelectorsEl) return; 

        stageSelectorsEl.innerHTML = ''; // æ¸…ç©ºç¾æœ‰å…§å®¹

        stages.forEach(stage => {
            const button = document.createElement('button');
            button.textContent = stage;
            
            // è¨­å®šé¸ä¸­ç‹€æ…‹çš„ CSS class
            const isSelected = stage === currentStage;
            button.className = isSelected ? 'selected-stage' : ''; 

            // â­ï¸ é—œéµï¼šé»æ“ŠæŒ‰éˆ•ï¼Œåˆ‡æ›é—œå¡ä¸¦ç«‹å³å•Ÿå‹•æ–°æ¸¬é©—
            button.onclick = () => {
                currentStage = stage;     // 1. æ›´æ–°ç•¶å‰é—œå¡è®Šæ•¸
                renderStageSelectors();   // 2. é‡æ–°æ¸²æŸ“æŒ‰éˆ•ï¼ˆæ›´æ–°é¸ä¸­æ¨£å¼ï¼‰
                startNewQuiz();           // 3. ç«‹å³å•Ÿå‹•è©²é—œå¡çš„ç¬¬ä¸€é¡Œ
            };
            
            stageSelectorsEl.appendChild(button);
        });
    }

    /**
     * é–‹å§‹æ–°çš„æ¸¬é©— (é‡è¨­åˆ†æ•¸ï¼Œç¯©é¸é¡Œç›®ï¼Œé¡¯ç¤ºç¬¬ä¸€é¡Œ)
     */
    function startNewQuiz() {
        score = 0;
        currentQuestionIndex = 0;
        
        // æ ¹æ“šé¸æ“‡çš„é—œå¡ç¯©é¸é¡Œç›®
        // é¡Œç›®æ ¼å¼ï¼š[å¥å­, [é¸é …], é—œå¡å] -> é—œå¡åæ˜¯ç¬¬ 3 å€‹å…ƒç´  (ç´¢å¼• 2)ï¼Œä½†æ‚¨çš„è³‡æ–™çµæ§‹æ˜¯ [å¥å­, æ­£ç¢ºç­”æ¡ˆ, æ··æ·†1, æ··æ·†2, é—œå¡å] (ç´¢å¼• 4)
        // æª¢æŸ¥æ‚¨çš„ quizData æ ¼å¼ï¼Œæ‡‰è©²æ˜¯ q[2] æˆ– q[3]ï¼š
        // æ‚¨çš„ quizData çµæ§‹ï¼š[ [å¥å­éƒ¨åˆ†1, å¥å­éƒ¨åˆ†2, å¥å­éƒ¨åˆ†3], [æ­£ç¢ºç­”æ¡ˆ, éŒ¯èª¤é¸é …1, éŒ¯èª¤é¸é …2], "å¹¼å…’åœ’å°ç­" ]
        // é€™è£¡çš„ q[2] æ‡‰è©²æ˜¯é—œå¡åï¼š
        filteredQuizData = quizData.filter(q => q[2] === currentStage);
        
        // ğŸš¨ ä¿®æ­£ï¼šæ‚¨çš„ quizData é—œå¡ååœ¨æ¯å€‹å­é™£åˆ—çš„æœ€å¾Œä¸€å€‹å…ƒç´ ï¼Œå³ç´¢å¼• 2ã€‚
        // ä¾‹å¦‚ï¼š [["å¤ªé™½å‡ºä¾†äº†ï¼Œå…¬é›åœ¨å«", "ã€‚", "å–”"], ["å–”", "å‘€", "å•Š"], "å¹¼å…’åœ’å°ç­"]
        // é€™è£¡çš„ q[2] æ‰æ˜¯ "å¹¼å…’åœ’å°ç­"

        // ç”±æ–¼æ‚¨çš„ quizData çµæ§‹æ˜¯ [ [å¥å­é™£åˆ—], [é¸é …é™£åˆ—], é—œå¡å ]ï¼Œ
        // é—œå¡åæ˜¯ä¸»é™£åˆ—çš„ç¬¬ä¸‰å€‹å…ƒç´  (ç´¢å¼• 2)ã€‚

        // ç¢ºä¿æœ‰é¡Œç›®
        if (filteredQuizData.length === 0) {
             languageGameEl.innerHTML = `<div><h4>ğŸš§ ${currentStage} é¡Œç›®å»ºè¨­ä¸­... (ç›®å‰æ²’æœ‰æ‰¾åˆ°è©²é—œå¡é¡Œç›®)</h4></div>`;
             feedbackEl.innerHTML = '';
             return;
        }

        totalQuestions = filteredQuizData.length;
        feedbackEl.innerHTML = `<h3>ç›®å‰åˆ†æ•¸: 0 / ${totalQuestions}</h3>`;
        displayQuizQuestion();
    }
    
    /**
     * é¡¯ç¤ºç•¶å‰é¡Œç›®
     */
    function displayQuizQuestion() {
        if (currentQuestionIndex >= filteredQuizData.length) {
            // æ¸¬é©—çµæŸ
            languageGameEl.innerHTML = `<div>
                <h4>ğŸ‰ æ­å–œå®Œæˆ ${currentStage} æ¸¬é©—ï¼</h4>
                <p>ç¸½å…±ç­”å° ${score} é¡Œï¼Œç¸½é¡Œæ•¸ ${totalQuestions} é¡Œã€‚</p>
                <p>ä½ çœŸæ˜¯å¤ªæ£’äº†ï¼ä¼‘æ¯ä¸€ä¸‹ï¼Œæˆ–è©¦è©¦ä¸‹ä¸€å€‹é—œå¡å§ï¼</p>
            </div>`;
            return;
        }
        
        const qData = filteredQuizData[currentQuestionIndex];
        // qData çµæ§‹: [ [å¥å­é™£åˆ—], [é¸é …é™£åˆ—], é—œå¡å ]
        const sentenceParts = qData[0]; // [éƒ¨åˆ†1, éƒ¨åˆ†2, éƒ¨åˆ†3]
        const optionsArray = qData[1]; // [æ­£ç¢ºç­”æ¡ˆ, æ··æ·†é¸é …1, æ··æ·†é¸é …2]
        
        // å¾é¸é …é™£åˆ—ä¸­å–å¾—æ­£ç¢ºç­”æ¡ˆï¼ˆå®ƒç¸½æ˜¯ç¬¬ä¸€å€‹ï¼‰
        const correctAnswer = optionsArray[0];

        // å°‡æ‰€æœ‰é¸é … æ‰“äº‚
        let options = [...optionsArray];
        options.sort(() => Math.random() - 0.5);

        // ç”Ÿæˆé¡Œç›®æ–‡å­— (å°‡ç©ºç¼ºéƒ¨åˆ†ç”¨åº•ç·šè¡¨ç¤º)
        const questionText = `${sentenceParts[0]} <span class="fill-in-gap"> (____) </span> ${sentenceParts[1]}`;

        // ç”Ÿæˆé¸é …æŒ‰éˆ•
        const optionsHTML = options.map(opt => 
            // æ³¨æ„ï¼šé€™è£¡çš„ checkAnswer å‡½å¼éœ€è¦æ¥æ”¶æ­£ç¢ºç­”æ¡ˆï¼Œä»¥ä¾¿æ¯”å°
            `<button onclick="checkAnswer('${opt.replace(/'/g, "\\'")}', '${correctAnswer.replace(/'/g, "\\'")}')">${opt}</button>`
        ).join('');
        
        languageGameEl.innerHTML = `
            <div id="current-quiz-card">
                <h4>ç¬¬ ${currentQuestionIndex + 1} é¡Œ:</h4>
                <div class="question-text">${questionText}</div>
                <div id="options-area">${optionsHTML}</div>
            </div>
        `;
        
        // æ›´æ–°åˆ†æ•¸é¡¯ç¤º (é¡Œç›®é€²è¡Œä¸­)
        feedbackEl.innerHTML = `<h3>ç›®å‰åˆ†æ•¸: ${score} / ${totalQuestions}</h3>`;
    }

    /**
     * æª¢æŸ¥ç­”æ¡ˆ (ä¿æŒä¸è®Š)
     */
    function checkAnswer(selectedOption, correctAnswer) {
        // ç¦ç”¨æ‰€æœ‰æŒ‰éˆ•ï¼Œé¿å…é‡è¤‡é»æ“Š
        const optionsArea = document.getElementById('options-area');
        if (optionsArea) {
            optionsArea.querySelectorAll('button').forEach(btn => btn.disabled = true);
        }

        let isCorrect = selectedOption === correctAnswer;
        
        // è¦–è¦ºå›é¥‹
        optionsArea.querySelectorAll('button').forEach(btn => {
            if (btn.textContent === correctAnswer) {
                // æ­£ç¢ºç­”æ¡ˆ
                btn.style.backgroundColor = '#d4edda'; // ç¶ è‰²
                btn.style.color = '#155724';
            } else if (btn.textContent === selectedOption) {
                // éŒ¯èª¤ç­”æ¡ˆ
                btn.style.backgroundColor = '#f8d7da'; // ç´…è‰²
                btn.style.color = '#721c24';
            }
        });

        // è™•ç†åˆ†æ•¸å’Œé€²åº¦
        if (isCorrect) {
            score++;
            feedbackEl.innerHTML += `<p style="color:#28a745; font-weight:bold;">âœ… ç­”å°äº†ï¼å¤ªæ£’äº†ï¼</p>`;
        } else {
             feedbackEl.innerHTML += `<p style="color:#dc3545; font-weight:bold;">âŒ ç­”éŒ¯äº†ï¼Œæ­£ç¢ºç­”æ¡ˆæ˜¯ ${correctAnswer}ã€‚</p>`;
        }
        
        // æ›´æ–°åˆ†æ•¸é¡¯ç¤º
        const scoreH3 = feedbackEl.querySelector('h3');
        if (scoreH3) scoreH3.textContent = `ç›®å‰åˆ†æ•¸: ${score} / ${totalQuestions}`;

        // 0.8 ç§’å¾Œåˆ‡æ›åˆ°ä¸‹ä¸€é¡Œ
        currentQuestionIndex++;
        setTimeout(displayQuizQuestion, 800); 
    }

    // ====================================== [ åˆå§‹åŒ– ] =======================================
    
    /**
     * ç¨ç«‹çš„èªæ–‡ç·´ç¿’åˆå§‹åŒ–å‡½å¼
     */
    function initLanguageQuiz() {
        // ç¢ºä¿ DOM å…ƒç´ å­˜åœ¨
        if (!stageSelectorsEl || !languageGameEl || !feedbackEl) {
            console.error('Language Quiz DOM elements not found. Retrying in 50ms.');
            setTimeout(initLanguageQuiz, 50); 
            return;
        }
        
        renderStageSelectors(); // é¡¯ç¤ºé—œå¡æŒ‰éˆ•
        
        // é é¢è¼‰å…¥æ™‚ï¼Œç›´æ¥å•Ÿå‹• 'å¹¼å…’åœ’å°ç­' çš„æ¸¬é©—ï¼Œç«‹å³é¡¯ç¤ºé¡Œç›®
        startNewQuiz(); 
    }

    // æš´éœ²çµ¦å…¨åŸŸç’°å¢ƒ
    window.startNewQuiz = startNewQuiz;
    window.initLanguageQuiz = initLanguageQuiz;
    window.checkAnswer = checkAnswer; // ç¢ºä¿ options çš„ onclick å¯ä»¥å‘¼å«åˆ°å®ƒ

    // ç¨ç«‹å•Ÿå‹•ç›£è½å™¨ (ç¢ºä¿åœ¨æ‰€æœ‰ DOM å…ƒç´ è¼‰å…¥å¾Œï¼Œèªæ–‡ç·´ç¿’æ‰å•Ÿå‹•)
    document.addEventListener('DOMContentLoaded', function() {
        initLanguageQuiz();
    });
</script>






<div class="new-section quiz-area">
    <h2> â­èªæ–‡ç·´ç¿’åŸºç¤</h2>
    
    <div id="quiz-stage-selectors" class="stage-selectors">
        </div>
    
    <div id="language-game" class="question-container">
    </div>
    
    <div id="quiz-feedback-area" class="feedback-area">
    </div>







    
/* ========================================================== */
/* ========= â­ èªæ–‡ç·´ç¿’å€å¡Š (quiz-area) å°ˆå±¬æ¨£å¼ â­ ========= */
/* ========================================================== */

.quiz-area {
    width: 90%;                     /* è¨­ç½®å€å¡Šå¯¬åº¦ */
    max-width: 800px; 
    /* è²¼ä¸Šä»¥ä¸‹å…©è¡Œï¼Œä»¥ç¢ºä¿å®ƒåœ¨ Flex å®¹å™¨å…§æ°´å¹³ç½®ä¸­ */
           /* èª¿æ•´ç‚ºç•¥å¯¬ï¼Œè®“é¡Œç›®é¸é …ç©ºé–“æ›´è¶³ */
    margin-left: auto;
    margin-right:auto;
    margin: 30px auto;              /* å¢åŠ ä¸Šä¸‹å¤–é‚Šè·ï¼Œæ›´é†’ç›® */
    padding: 25px;
    border: 4px solid #FF8C00;      /* ä¸»é¡Œé‚Šæ¡† (åŠ ç²—) */
    border-radius: 20px;            /* é‚Šè§’æ›´åœ“æ½¤ */
    background-color: #FFF9E6;      /* æŸ”å’ŒèƒŒæ™¯è‰² (ç•¥äº®ä¸€é») */
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15); /* é™°å½±æ›´æ˜é¡¯ */
    transition: all 0.3s ease-out;  /* åŠ å…¥éæ¸¡æ•ˆæœ */
}

.quiz-area h2 {
    text-align: center;
    color: #D35400;                 /* ä¸»æ¨™é¡Œé¡è‰² (æ·±æ©˜) */
    font-size: 36px;                /* ä¸»æ¨™é¡Œå­—é«”å¤§å° (ç•¥å¤§) */
    margin-bottom: 25px;
    font-weight: 800;               /* åŠ ç²— */
}

/* --- é—œå¡é¸æ“‡æŒ‰éˆ• --- */
.stage-selectors button {
    padding: 15px 20px;             /* å¢åŠ å…§é‚Šè· */
    margin: 8px 10px; 
    font-size: 22px;                /* éšæ®µé¸æ“‡æŒ‰éˆ•å­—é«”å¤§å° */
    cursor: pointer;
    border-radius: 12px;
    border: 2px solid #D35400;      /* å¢åŠ é‚Šæ¡†ï¼Œä½¿æœªé¸ä¸­çš„ä¹Ÿæ›´ç«‹é«” */
    background-color: #FFECB3;      /* æ·ºé»ƒè‰²èƒŒæ™¯ */
    color: #D35400;
    font-weight: bold;
    transition: background-color 0.3s, transform 0.1s, border-color 0.3s;
}

/* é¸ä¸­çš„é—œå¡æŒ‰éˆ•æ¨£å¼ (é‡é»å¼·èª¿) */
.stage-selectors .selected-stage {
    background-color: #FF8C00;      /* ä¸»é¡Œè‰² */
    color: #FFF;
    font-weight: bold;
    border: 2px solid #D35400;      /* ç¶­æŒé‚Šæ¡† */
    transform: scale(1.05);         /* ç•¥å¾®æ”¾å¤§ï¼Œæ›´çªå‡º */
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
}

/* --- é¡Œç›®é¡¯ç¤ºå€å¡Š --- */
.question-container > div {
    padding: 30px;
    border: 3px solid #ffccff;      /* é‚Šæ¡†åŠ ç²— */
    border-radius: 15px; 
    background: #fff0f5;            /* ç²‰ç´…èƒŒæ™¯ */
    margin-top: 25px;               /* å¢åŠ ä¸Šæ–¹é–“éš” */
    box-shadow: inset 0 0 8px rgba(255, 105, 180, 0.2); /* å…§é™°å½±ï¼Œå¢å¼·å¡ç‰‡æ„Ÿ */
}

.question-container h4 {
    font-size: 24px;                /* é¡Œç›®åºè™Ÿ H4 å­—é«”å¤§å° */
    color: #555;
    margin-top: 0;
    margin-bottom: 25px;
    text-align: center;
}

/* é¡Œç›®æ–‡å­—æ¨£å¼ (åŒ…å«ç©ºç¼º) */
.question-text {
    font-size: 32px;                /* è®“é¡Œç›®å¥å­æ›´å¤§ã€æ›´é¡¯çœ¼ */
    line-height: 2;                 /* å¢åŠ è¡Œè·ï¼Œæ›´æ˜“è®€ */
    text-align: center;
    font-weight: 600;
}

/* è®“å¥å­ä¸­çš„ç©ºç¼ºåº•ç·šæ›´æ˜é¡¯ */
.question-text .fill-in-gap {
    color: #FF4500;                 /* äº®çœ¼æ©˜ç´… */
    font-weight: 900;
    text-decoration: underline;     /* åŠ ä¸Šåº•ç·š */
    text-decoration-thickness: 3px; /* åº•ç·šåŠ ç²— */
    margin: 0 10px;
}

/* --- é¸é …æŒ‰éˆ•é€šç”¨æ¨£å¼ --- */
#options-area button {
    font-size: 28px;                /* èª¿æ•´é¸é …æŒ‰éˆ•å­—é«”å¤§å° (æ›´é©åˆå°æ‰‹é»æ“Š) */
    width: 80%;                     /* ç•¥å¾®æ”¶çª„ï¼Œè¦–è¦ºä¸Šæ›´é›†ä¸­ */
    margin: 10px auto;
    display: block;
    padding: 18px 25px;             /* å¢åŠ é»æ“Šé¢ç© */
    border: 3px solid #1F618D;      /* å¢åŠ é‚Šæ¡†ï¼Œå¢å¼·é»æ“Šæ„Ÿ */
    border-radius: 10px;
    background-color: #ADD8E6;      /* é è¨­é¡è‰² (æ·ºè—) */
    color: #1F618D;
    font-weight: 800;               /* æ›´ç²— */
    box-shadow: 0 3px 0 #1F618D;    /* æ¨¡æ“¬ 3D æŒ‰éˆ•æ•ˆæœ */
}

#options-area button:hover:not(:disabled) {
    background-color: #87CEEB;      /* æ»‘é¼ æ‡¸åœæ•ˆæœ */
    transform: translateY(-4px);    /* æ‡¸åœæ™‚ç§»å‹•æ›´å¤š */
    box-shadow: 0 7px 0 #1F618D;    /* é™°å½±è®Šå¤§ */
}

#options-area button:active:not(:disabled) {
    transform: translateY(-1px);    /* é»æ“Šæ™‚ä¸‹å£“ */
    box-shadow: 0 0 0 #1F618D;
}

/* ç­”æ¡ˆå›é¥‹å€åŸŸ */
.feedback-area {
    text-align: center;
    margin-top: 30px;
    padding: 15px;
    border-top: 1px dashed #D35400;
}

.feedback-area h3 {
    font-size: 26px;
    color: #D35400;
}

.feedback-area p {
    font-size: 22px;
    margin-top: 10px;
}
 
/* ========================================================== */
/* ========= â­ èªæ–‡ç·´ç¿’å€å¡Š (quiz-area) å°ˆå±¬æ¨£å¼ â­ ========= */
/* ========================================================== */


const sceneryImages = ['elephant.jpg','tiger.jpg','animals.jpg','camel.jpg','capepeepara.jpg','fox.jpg','jellyfish.jpg','manyjellyfish.jpg','raccoon.jpg','whale.jpg','wolf.jpg' ];
    let currentImageIndex = 0;



    'ğŸ¶','ğŸ±','ğŸ­','ğŸ¹','ğŸ°','ğŸ¦Š','ğŸ»','ğŸ¼','ğŸ¨','ğŸ¯','ğŸ¦','ğŸ¸','ğŸµ','ğŸ¦„','ğŸ·','ğŸ®','ğŸ”','ğŸ¦‰','ğŸ¦‹','ğŸ™',

    // é£Ÿç‰©æ°´æœ (20)
    'ğŸ','ğŸŠ','ğŸ‹','ğŸŒ','ğŸ‰','ğŸ‡','ğŸ“','ğŸ«','ğŸˆ','ğŸ’','ğŸ‘','ğŸ¥­','ğŸ','ğŸ¥¥','ğŸ¥','ğŸ…','ğŸ†','ğŸ¥‘','ğŸ¥¦','ğŸŒ½',

    // ç”œé»é£²æ–™ (15)
    'ğŸ°','ğŸ‚','ğŸ§','ğŸ¦','ğŸ©','ğŸ«','ğŸ¬','ğŸ­','ğŸ¯','ğŸ¥¤','â˜•','ğŸ§‹','ğŸµ','ğŸ¼','ğŸº',

    // æ—¥å¸¸ç‰©ä»¶ (15)
    'â­','ğŸŒ™','â˜€ï¸','ğŸŒˆ','âš¡','ğŸ”¥','ğŸ’§','â„ï¸','ğŸŒ¸','ğŸŒº','ğŸŒ¼','ğŸ€','ğŸŒ»','ğŸŒ','ğŸš€',

    // äº¤é€šå·¥å…· (10)
    'ğŸš—','ğŸš•','ğŸš™','ğŸšŒ','ğŸš“','ğŸš’','ğŸš‘','ğŸšœ','âœˆï¸','ğŸš¤',

    // é‹å‹•å¨›æ¨‚ (10)
    'âš½','ğŸ€','ğŸˆ','âš¾','ğŸ¾','ğŸ','ğŸ³','ğŸ®','ğŸ¯','ğŸ²',

    // å…¶ä»–å¯æ„›ç¬¦è™Ÿ (10)
    'â¤ï¸','ğŸ§¡','ğŸ’›','ğŸ’š','ğŸ’™','ğŸ’œ','ğŸ–¤','ğŸ’–','ğŸ’','ğŸ’¯'



  HTML

<style>
/* --- CSS æ¨£å¼å€ --- */

/* è¿·å®®å°èˆªæŒ‰éˆ•ç¾åŒ– (å–ä»£åŸ stage-btn) */
.nav-btn, .clear-btn {
    padding: 10px 18px;
    margin: 1px;
    /* ä¿®æ­£ font-size:10x çš„æ½›åœ¨ç­†èª¤ */
    font-size: 16px; 
    color: white;
    border: none;
    border-radius: 50px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.2s ease;
}

/* ä¸Šä¸€å¼µ / ä¸‹ä¸€å¼µ æŒ‰éˆ• (æ©˜è‰²) */
.nav-btn {
    background: #ff8c00;
}
.nav-btn:hover:not(:disabled) {
    background: #e67e22;
    transform: scale(1.05);
}
.nav-btn:disabled {
    background: #ccc; /* ç¦ç”¨æ™‚çš„é¡è‰² */
    cursor: not-allowed;
}

/* æ¸…é™¤ç•«ç·šæŒ‰éˆ• (ç´…è‰²) */
.clear-btn {
    margin-left: 15px; /* èˆ‡å°èˆªæŒ‰éˆ•åˆ†éš” */
    background: #dc3545;
}
.clear-btn:hover {
    background: #c82333;
    transform: scale(1.05);
}

/* æ©˜è‰²ç•«ç­†æ¸¸æ¨™ï¼šç¶å®šåˆ°æ•´å€‹è¿·å®®å®¹å™¨ */
#maze-container:hover {
    cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28"><circle cx="14" cy="14" r="12" fill="%23FF8C00" opacity="0.9"/><circle cx="14" cy="14" r="6" fill="%23FFF"/></svg>') 14 14, auto;
}
</style>

<div id="maze-app" style="text-align:center;">
    <div style="margin-bottom:15px;">
        <button onclick="prevMaze()" class="nav-btn" id="prev-btn">ä¸Šä¸€å¼µ</button>
        <span id="maze-status" style="margin:0 15px; font-size:1.2em; font-weight:bold; color:#ff8c00;">é—œå¡ 1/100</span>
        <button onclick="nextMaze()" class="nav-btn" id="next-btn">ä¸‹ä¸€å¼µ</button>

        <button onclick="clearPath()" class="clear-btn">æ¸…é™¤ç•«ç·š</button>
    </div>

    <div id="maze-container" style="position:relative;display:inline-block;box-shadow:0 0 15px rgba(0,0,0,0.3);border-radius:12px;overflow:hidden;">
        <img id="maze-img" src="maze1.jpg" style="display:block;max-width:100%;height:auto;">
        <canvas id="draw-canvas"></canvas>
    </div>
</div>

<script>
// --- JavaScript é‚è¼¯å€ ---

// ç•«å¸ƒç›¸é—œè®Šæ•¸
let canvas, ctx, drawing = false;
const lineColor = "#FF6B00";     // æ©˜è‰²
const lineWidth = 8;
const MAX_MAZE = 100;            // *** ä¾æ‚¨çš„éœ€æ±‚è¨­å®šç‚º 100 å¼µè¿·å®®åœ– ***
let currentMaze = 1;             // ç•¶å‰é—œå¡è™Ÿç¢¼

function initCanvas() {
    const img = document.getElementById('maze-img');
    canvas = document.getElementById('draw-canvas');
    ctx = canvas.getContext('2d');

    // è®“ canvas è·Ÿåœ–ç‰‡å¤§å°å®Œå…¨ä¸€æ¨£
    canvas.width = img.clientWidth;
    canvas.height = img.clientHeight;
    canvas.style.position = 'absolute';
    canvas.style.top = 0;
    canvas.style.left = 0;
    
    // è®“ canvas ä¸€ç›´å¯ä»¥æ¥æ”¶äº‹ä»¶ (å¯¦ç¾å°ç•«å®¶æ‹–æ›³çš„é—œéµ)
    canvas.style.pointerEvents = 'auto'; 

    // æ¸…ç©ºç•«å¸ƒä¸¦è¨­å®šç•«ç­†æ¨£å¼
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.lineCap = 'round';
    ctx.lineJoin = 'round';
}

// è¼‰å…¥è¿·å®®åœ–ç‰‡ä¸¦æ›´æ–°ç‹€æ…‹
function loadMaze(num) {
    if (num < 1 || num > MAX_MAZE) return; // é˜²æ­¢è¶Šç•Œ

    currentMaze = num;
    const img = document.getElementById('maze-img');
    const status = document.getElementById('maze-status');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');

    // 1. æ›´æ–°åœ–ç‰‡ä¾†æº
    img.src = `maze${num}.jpg`; 

    // 2. æ›´æ–°é—œå¡é¡¯ç¤ºæ–‡å­—
    status.textContent = `é—œå¡ ${num}/${MAX_MAZE}`;

    // 3. èª¿æ•´æŒ‰éˆ•ç‹€æ…‹ (ç¦ç”¨/å•Ÿç”¨)
    prevBtn.disabled = (num === 1);
    nextBtn.disabled = (num === MAX_MAZE);
    
    // 4. åœ–ç‰‡è¼‰å…¥å®Œæˆå¾Œé‡æ–°åˆå§‹åŒ–ç•«å¸ƒ
    img.onload = () => {
        initCanvas();
        clearPath(); // æ›åœ–æ™‚è‡ªå‹•æ¸…æ‰èˆŠçš„ç·š
    };
    
    // å¦‚æœåœ–ç‰‡å·²ç¶“è¼‰å…¥éï¼Œä¹Ÿè¦ç¢ºä¿ç•«å¸ƒè¢«åˆå§‹åŒ–
    if (img.complete) {
        initCanvas();
        clearPath(); 
    }
}

// å°èˆªåˆ°ä¸‹ä¸€å¼µè¿·å®®
function nextMaze() {
    loadMaze(currentMaze + 1);
}

// å°èˆªåˆ°ä¸Šä¸€å¼µè¿·å®®
function prevMaze() {
    loadMaze(currentMaze - 1);
}

// é–‹å§‹ç•«ç·š (ç¶å®šåœ¨ canvas ä¸Š)
function startDraw(e) {
    // ç¢ºä¿åªåœ¨æ»‘é¼ å·¦éµæŒ‰ä¸‹æ™‚é–‹å§‹ç¹ªåœ–
    if (e.buttons !== 1 && e.type !== 'touchstart') return; 

    drawing = true;
    
    // å–å¾—ç›¸å°æ–¼ canvas çš„åº§æ¨™
    const rect = canvas.getBoundingClientRect();
    const x = e.clientX || e.touches[0].clientX;
    const y = e.clientY || e.touches[0].clientY;
    
    ctx.beginPath();
    ctx.moveTo(x - rect.left, y - rect.top);

    // é˜²æ­¢è§¸æ§äº‹ä»¶æ»¾å‹•é é¢
    if (e.type === 'touchstart' || e.type === 'touchmove') e.preventDefault();
}

// ç•«ç·šä¸­
function draw(e) {
    if (!drawing) return;
    
    // å–å¾—ç›¸å°æ–¼ canvas çš„åº§æ¨™
    const rect = canvas.getBoundingClientRect();
    const x = e.clientX || e.touches[0].clientX;
    const y = e.clientY || e.touches[0].clientY;
    
    ctx.globalCompositeOperation = 'source-over';
    ctx.strokeStyle = lineColor;
    ctx.lineWidth = lineWidth;
    ctx.lineTo(x - rect.left, y - rect.top);
    ctx.stroke();

    if (e.type === 'touchmove') e.preventDefault();
}

// çµæŸç•«ç·š
function stopDraw() {
    if (!drawing) return;
    drawing = false;
    ctx.closePath(); 
}

// æ¸…é™¤ç•«çš„ç·š
function clearPath() {
    if (ctx) ctx.clearRect(0, 0, canvas.width, canvas.height);
}

// ç¶å®šäº‹ä»¶ï¼ˆæ”¯æ´æ»‘é¼  + è§¸æ§ï¼‰
window.addEventListener('load', () => {
    loadMaze(currentMaze); // é è¨­è¼‰å…¥ç¬¬ä¸€é—œ
    
    const container = document.getElementById('maze-container');
    const canvasEl = document.getElementById('draw-canvas');

    // æ»‘é¼ äº‹ä»¶ç¶å®šåˆ° canvas
    canvasEl.addEventListener('mousedown', startDraw);
    canvasEl.addEventListener('mousemove', draw);
    canvasEl.addEventListener('mouseup', stopDraw);
    
    // åœ¨ container ä»¥å¤–æˆ–åœ¨æ–‡ä»¶ä¸Šæ”¾é–‹æ»‘é¼ æ™‚ï¼Œä¹Ÿæ‡‰åœæ­¢ç¹ªåœ–
    container.addEventListener('mouseleave', stopDraw);
    document.addEventListener('mouseup', stopDraw); 

    // æ‰‹æ©Ÿè§¸æ§æ”¯æ´
    canvasEl.addEventListener('touchstart', startDraw);
    canvasEl.addEventListener('touchmove', draw);
    canvasEl.addEventListener('touchend', stopDraw);
    canvasEl.addEventListener('touchcancel', stopDraw); 
});
</script>
